Seminar 5: Fitting and interpreting linear models (low volume)
==============================================================
### Lauren Chong

Load the data:
```{r}
library(lattice)
library(reshape2)
prDat <- read.table("GSE4051_data.tsv")
str(prDat, max.level = 0)
prDes <- readRDS("GSE4051_design.rds")
str(prDes)
```

Write a function to extract info for a list of genes:
```{r}
prepareData <- function(genes) {
  miniDat <- prDat[genes,]
  miniDat <- data.frame(
    gExp = as.vector(t(as.matrix(miniDat))),
    gene = factor(rep(genes, each = ncol(miniDat)), levels = genes)
  )
  miniDat <- suppressWarnings(data.frame(prDes, miniDat))
}

# Test it out
(luckyGenes <- c("1419655_at","1438815_at"))
jDat <- prepareData(luckyGenes)
str(jDat)
head(jDat)

stripplot(gExp ~ devStage | gene, jDat,
          group = gType, jitter.data = TRUE,
          auto.key = TRUE, type = c('p', 'a'), grid = TRUE)
```
